<!DOCTYPE html>
<html lang="lt" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8" xmlns:th="http://www.thymeleaf.org">
    <title>Welcome</title>
    <link rel="shortcut icon" href="#">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css">
    <link th:href="@{/css/main.css}" rel="stylesheet"/>
    <script type="text/javascript" th:src="@{/js/main.js}" defer></script>
</head>
<body>
<header th:replace="~{fragments/fragments.html :: header}"></header>

<main>
    <hr>
    <div class="loginDiv">
        <h1 th:inline="text">Hello <span th:remove="tag" sec:authentication="name">thymeleaf</span>!</h1>
        <h2>Welcome</h2>
        <p>Spring Security Thymeleaf tutorial</p>
        <div sec:authorize="hasRole('USER')">Text visible to user.</div>
        <div sec:authorize="hasRole('ADMIN')">Text visible to admin.</div>
        <div sec:authorize="hasAuthority('ADMIN')">!!!Text visible to admin!!!</div>
        <div sec:authorize="isAuthenticated()">Text visible only to
            authenticated users.
        </div>
        Authenticated username:
        <div sec:authentication="name"></div>
        Authenticated user roles:
        <div sec:authentication="principal.authorities"></div>

        <div th:text="${#authentication.name}">
            The value of the "name" property of the authentication object should appear here.
        </div>

        <div th:if="${#authorization.expression('hasRole(''ADMIN'')')}">
            This will only be displayed if authenticated user has role ADMIN.
        </div>


        <form th:action="@{/logout}" method="post">
            <input type="submit" value="Sign Out"/>
        </form>
    </div>
    <hr>
</main>

<footer th:replace="~{fragments/fragments.html :: footer}"></footer>
</body>
</html>
